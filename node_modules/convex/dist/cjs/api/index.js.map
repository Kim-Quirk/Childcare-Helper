{
  "version": 3,
  "sources": ["../../../src/api/index.ts"],
  "sourcesContent": ["/**\n * All of the utility types to describe a Convex API of queries and mutations\n */\n\nimport { ArgsArray } from \"../server/registration.js\";\nimport { Expand, PickByValue, UnionToIntersection } from \"../type_utils.js\";\nimport { Value } from \"../values/value.js\";\n\n/**\n * The type of a Convex function in a {@link GenericAPI}.\n *\n * @public\n */\nexport type ConvexFunction = (args?: any) => any;\n\n/**\n * Description of the Convex functions available to an application.\n *\n * This is a generic type that expresses the shape of API types created by\n * `npx convex dev`. It's used to make the Convex clients type-safe.\n *\n * @public\n */\nexport type GenericAPI = {\n  publicQueries: Record<string, ConvexFunction>;\n  allQueries: Record<string, ConvexFunction>;\n  publicMutations: Record<string, ConvexFunction>;\n  allMutations: Record<string, ConvexFunction>;\n  publicActions: Record<string, ConvexFunction>;\n  allActions: Record<string, ConvexFunction>;\n};\n\n/**\n * Helper types for interacting with the overall API type\n */\n\n/**\n * The names of query functions in a Convex API.\n *\n * @public\n */\nexport type QueryNames<API extends GenericAPI> = keyof API[\"allQueries\"] &\n  string;\n\n/**\n * The names of public query functions in a Convex API.\n *\n * @public\n */\nexport type PublicQueryNames<API extends GenericAPI> =\n  keyof API[\"publicQueries\"] & string;\n\n/**\n * The names of mutation functions in a Convex API.\n *\n * @public\n */\nexport type MutationNames<API extends GenericAPI> = keyof API[\"allMutations\"] &\n  string;\n\n/**\n * The names of public mutation functions in a Convex API.\n *\n * @public\n */\nexport type PublicMutationNames<API extends GenericAPI> =\n  keyof API[\"publicMutations\"] & string;\n\n/**\n * The names of actions in a Convex API.\n *\n * @public\n */\nexport type ActionNames<API extends GenericAPI> = keyof API[\"allActions\"] &\n  string;\n\n/**\n * The names of public query functions in a Convex API.\n *\n * @public\n */\nexport type PublicActionNames<API extends GenericAPI> =\n  keyof API[\"publicActions\"] & string;\n/**\n * The type of a query function in a Convex API.\n *\n * @public\n */\nexport type NamedQuery<\n  API extends GenericAPI,\n  Name extends QueryNames<API>\n> = API[\"allQueries\"][Name];\n\n/**\n * The type of a mutation function in a Convex API.\n *\n * @public\n */\nexport type NamedMutation<\n  API extends GenericAPI,\n  Name extends MutationNames<API>\n> = API[\"allMutations\"][Name];\n\n/**\n * The type of an action in a Convex API.\n *\n * @public\n */\nexport type NamedAction<\n  API extends GenericAPI,\n  Name extends ActionNames<API>\n> = API[\"allActions\"][Name];\n\n/**\n * The type of the arguments to a Convex function.\n *\n * This is represented as a single object mapping argument names to values.\n * Functions that don't need any arguments object are represented as `{}`.\n * @public\n */\nexport type ArgsObject<F extends (args?: Record<string, Value>) => any> =\n  Parameters<F>[\"length\"] extends 0\n    ? // eslint-disable-next-line @typescript-eslint/ban-types\n      {}\n    : Parameters<F>[0] & Record<string, Value>;\n\n/**\n * An tuple type of the (maybe optional) arguments to `F`.\n *\n * This type is used to make methods involving arguments type safe while allowing\n * skipping the arguments for functions that don't require arguments.\n *\n * @public\n */\nexport type OptionalRestArgs<F extends (args?: Record<string, Value>) => any> =\n  Parameters<F>[\"length\"] extends 0\n    ? // eslint-disable-next-line @typescript-eslint/ban-types\n      [args?: {}]\n    : [args: Parameters<F>[0]];\n\n/**\n * A tuple type of the (maybe optional) arguments to `F`, followed by an options\n * object of type `Options`.\n *\n * This type is used to make methods like `useQuery` type-safe while allowing\n * 1. Skipping arguments for functions that don't require arguments.\n * 2. Skipping the options object.\n * @public\n */\nexport type ArgsAndOptions<\n  F extends (args?: Record<string, Value>) => any,\n  Options\n> = Parameters<F>[\"length\"] extends 0\n  ? // eslint-disable-next-line @typescript-eslint/ban-types\n    [args?: {}, options?: Options]\n  : [args: Parameters<F>[0], options?: Options];\n\n/**\n * Internal Codegen Type Helpers\n */\n\n/**\n * Generate the fully-qualified query/mutation name of an export.\n *\n * This is `path/to/module:export` or `path/to/module` for the default export.\n */\ntype FunctionName<\n  FilePath extends string,\n  ExportName extends string\n> = ExportName extends \"default\" ? FilePath : `${FilePath}:${ExportName}`;\n\n/**\n * Generate a type of this module where each export is renamed to its\n * fully-qualified {@link FunctionName}.\n */\ntype NameModule<FilePath extends string, Module extends Record<string, any>> = {\n  [ExportName in keyof Module as FunctionName<\n    FilePath,\n    ExportName & string\n  >]: Module[ExportName];\n};\n\n/**\n * Name and merge together all of the exports in the `convex/` directory into\n * a flat object type.\n */\ntype MergeAllExports<Modules extends Record<string, Record<string, any>>> =\n  UnionToIntersection<\n    {\n      [FilePath in keyof Modules]: NameModule<\n        FilePath & string,\n        Modules[FilePath]\n      >;\n    }[keyof Modules]\n  >;\n\ntype UndefinedToNull<T> = T extends void ? null : T;\n\n/**\n * If this function has an argument, name it `args` so it's pretty in editors.\n */\ntype NameArgs<Args extends ArgsArray> = Args[\"length\"] extends 0\n  ? []\n  : [args: Args[0]];\n\n/**\n * Converts a map of query and mutation types into their client form.\n *\n * This is done by:\n * - Unwrapping `Promise` if it's in the output.\n * - Switching functions that output `undefined` to `null`.\n *\n */\ntype ConvertToClientFunctions<FunctionsByName extends Record<string, any>> = {\n  [Name in keyof FunctionsByName]: (\n    ...args: NameArgs<FunctionsByName[Name][\"args\"]>\n  ) => UndefinedToNull<Awaited<FunctionsByName[Name][\"output\"]>>;\n};\n\n/**\n * Create the API type from the types of all of the modules.\n *\n * Input is an object mapping file paths to the type of each module.\n *\n * For internal use by Convex code generation.\n *\n * @public\n */\nexport type ApiFromModules<\n  Modules extends Record<string, Record<string, any>>\n> = {\n  publicQueries: Expand<\n    ConvertToClientFunctions<\n      PickByValue<MergeAllExports<Modules>, { isQuery: true; isPublic: true }>\n    >\n  >;\n  allQueries: Expand<\n    ConvertToClientFunctions<\n      PickByValue<MergeAllExports<Modules>, { isQuery: true }>\n    >\n  >;\n  publicMutations: Expand<\n    ConvertToClientFunctions<\n      PickByValue<\n        MergeAllExports<Modules>,\n        { isMutation: true; isPublic: true }\n      >\n    >\n  >;\n  allMutations: Expand<\n    ConvertToClientFunctions<\n      PickByValue<MergeAllExports<Modules>, { isMutation: true }>\n    >\n  >;\n  publicActions: Expand<\n    ConvertToClientFunctions<\n      PickByValue<MergeAllExports<Modules>, { isAction: true; isPublic: true }>\n    >\n  >;\n  allActions: Expand<\n    ConvertToClientFunctions<\n      PickByValue<MergeAllExports<Modules>, { isAction: true }>\n    >\n  >;\n};\n"],
  "mappings": ";;;;;;;;;;;;;;AAAA;AAAA;",
  "names": []
}
